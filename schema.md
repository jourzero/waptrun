# Mongo DB Schema

<!-- TOC -->

-   [Mongo DB Schema](#mongo-db-schema)
    -   [Collection: project](#collection-project)
    -   [Collection: testkb](#collection-testkb)
    -   [Collection: cwe](#collection-cwe)
    -   [Collection: issues](#collection-issues)

<!-- /TOC -->

## Collection: project

| Attribute | Description                                                              |
| --------- | ------------------------------------------------------------------------ |
| name      | Project Name in YYYYMM-NAME-ENV format -- e.g. 201903-NinaWebRuntime-Lab |
| scope     | Short name for scope -- e.g. TG4                                         |
| scopeQry  | Descriptive name for scope/methodology -- e.g. OWASP-TG4                 |
| lastTID   | Last Test ID executed or viewed while testing -- e.g. OTG4-4.12.07       |

## Collection: testkb

| Attribute              | Description                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ---------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| TID                    | Unique Test ID -- e.g. W2-S01.02.3                                                                                                                                                                                                                                                                                                                                                                                                 |
| TSource                | Source for Test - e.g. WAHH2                                                                                                                                                                                                                                                                                                                                                                                                       |
| TTestName              | Test Name -- e.g. Search names and e-mail addresses in public resources                                                                                                                                                                                                                                                                                                                                                            |
| TType                  | Type of test -- e.g. Consult Public Resources                                                                                                                                                                                                                                                                                                                                                                                      |
| TDescription           | Test Description -- e.g. Perform searches on any names and e-mail addresses you have discovered in the application's content                                                                                                                                                                                                                                                                                                       |
| TIssueName             | Issue Description -- e.g. Uncontrolled indexing by web spiders, robots, and crawlers                                                                                                                                                                                                                                                                                                                                               |
| TIssueType             | Type of Issue -- e.g. Consult Public Resources                                                                                                                                                                                                                                                                                                                                                                                     |
| TImpact                | Security Impact Description                                                                                                                                                                                                                                                                                                                                                                                                        |
| TSeverity              | Numeric severity value: 0 (Info), 1 (Low), 2 (Medium), 3 (High)                                                                                                                                                                                                                                                                                                                                                                    |
| TSolution              | Solution description                                                                                                                                                                                                                                                                                                                                                                                                               |
| TTesterSupport         | Support text for security tester -- e.g. Perform searches on any names and e-mail addresses you have discovered in the application's content, such as contact information. Include items not rendered on-screen, such as HTML comments. In addition to web searches, perform news and group searches. Look for any technical details posted to Internet forums regarding the target application and its supporting infrastructure. |
| TPhase                 | Testing Phase -- e.g. 1. Map the Application's Content                                                                                                                                                                                                                                                                                                                                                                             |
| TSection               | Section of testing methodology -- e.g. 1.02. Consult Public Resources                                                                                                                                                                                                                                                                                                                                                              |
| TStep                  | Step number in methodology -- e.g. 1.2.3                                                                                                                                                                                                                                                                                                                                                                                           |
| TIssueBackground       | Issue Background                                                                                                                                                                                                                                                                                                                                                                                                                   |
| TRemediationBackground | Background for remediation (generic solution)                                                                                                                                                                                                                                                                                                                                                                                      |
| TRef1                  |
| TRef2                  |
| TTRef                  | wahh2/index.htm#w1.2.3                                                                                                                                                                                                                                                                                                                                                                                                             |
| TCweID                 |
| TStdTest               | Boolean: True if this considered one of our standard tests, False or empty otherwise.                                                                                                                                                                                                                                                                                                                                              |
| TPCI                   | Boolean: True if this is applicable for PCI-DSS, False or empty otherwise                                                                                                                                                                                                                                                                                                                                                          |
| TTop10                 | Boolean: True if this is one of the OWASP Top 10 issues, False or empty otherwise                                                                                                                                                                                                                                                                                                                                                  |
| TTop25                 | Boolean: True if this is one of the SANS/CWE Top 25 issues, False or empty otherwise                                                                                                                                                                                                                                                                                                                                               |

## Collection: cwe

For a description of each field, go to the Mitre site.

| Attribute               | Sample Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ID                      | 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Name                    | J2EE Misconfiguration: Missing Custom Error Page                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Weakness_Abstraction    | Variant                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Status                  | Incomplete                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Description_Summary     | The default error page of a web application should not display sensitive information about the software system.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Extended_Description    | A Web application must define a default error page for 4xx errors (e.g. 404), 5xx (e.g. 500) errors and catch java.lang.Throwable exceptions to prevent attackers from mining information from the application container's built-in error response. When an attacker explores a web site looking for vulnerabilities, the amount of information that the site provides is crucial to the eventual success or failure of any attempted attacks.                                                                                                                                                                                                                                                                                                                                                                                           |
| Related_Weaknesses      | ::NATURE:ChildOf:CWE ID:756:VIEW ID:1000:ORDINAL:Primary::NATURE:ChildOf:CWE ID:756:VIEW ID:699:ORDINAL:Primary::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Weakness_Ordinalities   |
| Applicable_Platforms    | ::LANGUAGE NAME:Java:LANGUAGE PREVALENCE:Undetermined::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Background_Details      |
| Alternate_Terms         |
| Modes_Of_Introduction   | ::PHASE:Architecture and Design::PHASE:Implementation::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Exploitation_Factors    |
| Likelihood_of_Exploit   |
| Common_Consequences     | ::SCOPE:Confidentiality:IMPACT:Read Application Data:NOTE:A stack trace might show the attacker a malformed SQL query string, the type of database being used, and the version of the application container. This information enables the attacker to target known vulnerabilities in these components.::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Detection_Methods       |
| Potential_Mitigations   | ::PHASE:Implementation:DESCRIPTION:Handle exceptions appropriately in source code.::PHASE:Implementation System Configuration:DESCRIPTION:Always define appropriate error pages. The application configuration should specify a default error page in order to guarantee that the application will never leak error messages to an attacker. Handling standard HTTP error codes is useful and user-friendly in addition to being a good security practice, and a good configuration will also define a last-chance error handler that catches any exception that could possibly be thrown by the application.::PHASE:Implementation:DESCRIPTION:Do not attempt to process an error or attempt to mask it.::PHASE:Implementation:DESCRIPTION:Verify return values are correct and do not supply sensitive information about the system.:: |
| Observed_Examples       |
| Functional_Areas        |
| Affected_Resources      |
| Taxonomy_Mappings       | ::TAXONOMY NAME:7 Pernicious Kingdoms:ENTRY NAME:J2EE Misconfiguration: Missing Error Handling::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Related_Attack_Patterns |
| Notes                   |

## Collection: issues

| Attribute              | Description                                                                                                      |
| ---------------------- | ---------------------------------------------------------------------------------------------------------------- |
| PrjName                | Project name in YYYYMM-NAME-ENV format -- e.g. 201801-Waptrun-Dev                                                |
| TID                    | Unique Test ID -- e.g. EXT-20161005T133806                                                                       |
| CweId                  | CWE ID -- e.g. 937                                                                                               |
| TIssueName             | Short Issue Name                                                                                                 |
| TIssueBackground       | Background describing the issue                                                                                  |
| TRemediationBackground | How to remediate generically. Researching for a fix may involve going to platform or language-specific guidance. |
| TSeverity              | Numeric severity value: 0 (Info), 1 (Low), 2 (Medium), 3 (High)                                                  |
| TRef1                  | URL for a testing reference                                                                                      |
| TRef2                  | URL for a 2nd testing reference                                                                                  |
| TSeverityText          | Severity text -- e.g. Medium                                                                                     |
| IURIs                  | List of URLs where the issue is present (\n separated)                                                           |
| IEvidence              | CLI outputs and/or raw HTML                                                                                      |
| IScreenshots           | HTML with image tags in base64                                                                                   |
| IPriority              | 0 (Info), 1 (Low), 2 (Medium), 3 (High), -1 (Tested), -2 (Fixed), -3 (TODO), -4 (Exclude)                        |
| IPriorityText          | Medium                                                                                                           |
| INotes                 | Notes explanining on the issue and its impact/priority (markdown-formatted)                                      |
